---
layout: page
title: "ZiNC Format"
---
The basic format of ZiNC messages is a three-part JSON structure:

```json
{
  "subscription": id,
  "request": { ... },
  "payload": { ... }
}
```

However, individual messages will generally not have all three parts,
but only those parts that are necessary to their function.

Unlike HTTP, streaming communications are fundamentally bi-directional;
messages can flow in both directions and can be initiated by either end.
Note however that ZiNC only specifies the _format_ of the communication;
the semantics are determined by the operations understood at each end of
the communication channel.  It is important that the two ends understand
what the other is capable of before beginning communication.

## Requests

Either end of the communication channel can initiate a _request_ on the
other end.

The simplest type of request just asks the other end to perform an
operation and does not send any additional data or want a response.
For example, a heartbeat operation might look like this:

```json
{
  "request": {
    "method": "invoke",
    "operation": "heartbeat"
  }
}
```

A simple request for a resource requires both a request object and a
subcription handle.  The handle will be sent back with a response object.
The handle is generated by the requestor and should be a unique integer.
It is the requestors responsibility to remember what to do with any
responses which are delivered to it with that handle.

```json
{
  "subscription": 14,
  "request": {
    "method": "get",
    "resource": "/path/to/resource"
  }
}
```

Unlike HTTP, which is strictly one-request, one-response, streaming
protocols can have any number of responses to a request.  The previous
two examples have had 0 and 1 responses respectively, but it is also
possible to "subscribe" to a resource, that is, to request it and all
future versions of it.

```json
{
  "subscription": 14,
  "request": {
    "method": "subscribe",
    "resource": "/path/to/resource"
  }
}
```

TODO: a put example (request & payload)
TODO: a create example (request & subscription)
TODO: cancel subscription

## Responses

Unlike requests, all responses have exactly the same format.
Each response is in response to a specific request and must
include the subscription handle.  It must also contain the
payload of the response.

Thus all responses are of the form:

```json
{
  "subscription": 14,
  "payload": {
    // payload as defined in JSONAPI
  }
}
```

It is immaterial in the definition of a response what _method_
was used to request the payload (_get_, _subscribe_, _create_, etc).
All that matters is that a contract has previously been agreed by
which a response is expected.

## Sequencing

Request comes before response
Messages may be arbitrarily interleaved (i.e. your response may not be next)
Requests can go either way but the ids are separate

## Verbs

subscribe
unsubscribe
get

put
update
create
delete

invoke
establish
teardown
